import groovy.json.JsonSlurper

node {

    stage("Setting repo checkout") {
        checkout scmGit(
            branches: [[name: 'docker_file']],
            userRemoteConfigs: [[url: 'https://github.com/lemonfisk/NEMEZIDA.git']])
    }


    stage('Get product version and default branch products') {
        def git_url = ""
        defaultBranch = "develop/5.2.7"
        def docker_content  = sh(script: "curl https://raw.githubusercontent.com/lemonfisk/TOKIO/${defaultBranch}/Dockerfile", returnStdout: true)
        content = sh(script: "grep -ioP '(?<=^from)\\s+\\S+' ${docker_content} | head -n 1 | cut -d ' ' -f 2", returnStdout: true)
        //content = sh(script: "grep -ioP '(?<=^from)\s+\S+' ${docker_content} | head -n 1 | cut -d ' ' -f 2)", returnStdout: true)
        println content
    }


}


